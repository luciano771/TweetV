 

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="img/pestaña.png" type="image/png">
    <title>TweetV</title>  



    <link rel="stylesheet" href="PublicacionesAI.css">
    <link rel="stylesheet" href="Modal.css">

    <script src="https://cdn.tailwindcss.com"></script>

 </head>
  <body>
    <!-- Contenedores donde se crearán los divs -->
    <div class="contenedor_principal">

      <!--Modal--->  
      <div id="myModal" class="modal">
        <div class="modal-content">
            <div class="relative h-10 w-full min-w-[200px]">
                <br>
                <!---text area-->
                <div class="w-full max-w-xs mx-auto">
                  <textarea id="inp" x-data="{
                  resize () {
                  $el.style.height = '0px';
                  $el.style.height = $el.scrollHeight + 'px'
                  }
                  }"
                  x-init="resize()"
                  @input="resize()"
                  type="text"
                  placeholder="mmmmm 🤔 🙈 ..."
                  class="flex w-full h-auto min-h-[150px] px-3 py-2 text-sm bg-white border rounded-md border-neutral-300 ring-offset-background placeholder:text-neutral-400 focus:border-neutral-300 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-neutral-400 disabled:cursor-not-allowed disabled:opacity-50"
                  ></textarea>
                  </div>
                <!---text area-->
                <br> 
                <button id="button1"onclick="toggleModal()" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded"> versionar &#128586;</button>
            </div>           
        </div>
      </div>
 
      <!--Modal--->
 
      <div class="contenedor_secundario"> 
        <div id="contenededor-spinner"><div id="posicion-spinner"><div id="spinner"></div></div></div>
          <button id="button1"onclick="toggleModal()" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">En que estas pensando? &#128584;</button>
          <div id="mi-div">
            <div class = "item">Hoy amanecí como 🌧️ en Buenos Aires... Nublado sin ganas de salir de la cama ☁️😴 ¿Alguien más quiere hacer el día más interesante? #DomingoNoSéQuéHacer</div>
            <div class = "item">¡Hola Argentina! ¿Alguien más se encuentra en modo indecisión hoy? 🤔 No sé si quedarme en casa y ver una peli o explorar nuevos lugares 🎬🌆 ¡Ayudenme con sus recomendaciones! #DomingoIndeciso</div>
            <div class = "item">Muy buen día, mi gente hermosa de Argentina! 😄 Hoy estoy como un ☕️ sin azúcar... sin idea de qué hacer. ¿Me tiran alguna sugerencia? ¡Los leo! #DomingoSinPlan</div>
            <div class = "item">¡Hola, argentinos y argentinas! 🇦🇷 Hoy me siento como un carrito 🛒 sin rumbo en un supermercado gigante 🛒 ¿Alguien quiere ser mi compañero(a) de aventuras y ayudarme a encontrar algo emocionante para hacer? 💃🎉 ¡Etiqueten a sus amigos y pongan el hashtag #DomingoIndeciso!</div>
          </div>
      </div>
  </div>
  
  <script>
  
    
    function Versionar(mensaje) {
      // Muestra un indicador de espera aquí (spinner, animación, etc.)
      // Por ejemplo, muestra un spinner en un div con el ID 'spinner'
      document.getElementById('contenededor-spinner').style.display = 'block';
    
      var url = "https://tweetv.onrender.com/publicacion";
      var data = { mensaje: mensaje };
      const controller = new AbortController();
      const timeoutId = setTimeout(() => controller.abort(), 60000); // Establece un tiempo de espera de 10 segundos (10000 milisegundos)
    
    
      fetch(url,{
        signal: controller.signal,
        method: "POST",
        body: JSON.stringify(data),
        headers: {
          "Content-Type": "application/json",
        },
      })
      .then(response => response.json())
      .then(data => {
        // Elimina el indicador de espera una vez que se recibe la respuesta
        document.getElementById('contenededor-spinner').style.display = 'none';
    
        for (const key in data) {
          if (data.hasOwnProperty(key)) {
            const bannerDiv = document.createElement('div');
            bannerDiv.className = 'item'
            bannerDiv.innerHTML = data[key];
            const bannerContainer = document.getElementById('mi-div');
            bannerContainer.appendChild(bannerDiv);
          }
        }
      })
      .catch(error => {
        console.error('Error:', error);
        // En caso de error, también elimina el indicador de espera
        document.getElementById('contenededor-spinner').style.display = 'none';
      });
    }
     
    
    
    
      document.addEventListener('DOMContentLoaded', function() {
          var modal = document.getElementById('myModal');
          var mensaje = document.getElementById('inp').value.trim();
          modal.style.display = 'none';
      });
    
      function toggleModal() {
          var modal = document.getElementById('myModal');
          var mensaje = document.getElementById('inp').value.trim();  
          if (modal.style.display === 'block') {
              modal.style.display = 'none';
              if(mensaje != ""){
                Versionar(mensaje);
              }
          } else {
              modal.style.display = 'block';
          }
      }

    
      window.onclick = function(event) {
          var modal = document.getElementById('myModal');
          if (event.target == modal) {
              modal.style.display = 'none';
              localStorage.setItem('modalOpened', 'false');
          }
      }
    
      document.addEventListener('keydown', function(event) {
          var mensaje = document.getElementById('inp').value.trim();
          var modal = document.getElementById('myModal');
          console.log(event.key); // Verifica la tecla presionada
          console.log(modal.style.display); // Verifica el estado de visualización del modal
          if (event.key === 'Enter' && modal.style.display === 'block') {
              console.log('Llamando a Versionar');
              toggleModal();
          }
      });

    
    
    
     
    
        </script>
</body>
</html>
 