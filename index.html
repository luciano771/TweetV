 

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="PublicacionesAI.css">
    <link rel="stylesheet" href="Modal.css">

    <script src="https://cdn.tailwindcss.com"></script>

 </head>
  <body>
    <!-- Contenedores donde se crearán los divs -->
    <div class="contenedor_principal">

      <!--Modal--->  
      <div id="myModal" class="modal">
      <div class="modal-content">
          <div class="relative h-10 w-full min-w-[200px]">
              <br>
              <input id="inp"
                class="peer h-full w-full rounded-[7px] border border-blue-gray-200 border-t-transparent bg-transparent px-3 py-2.5 font-sans text-sm font-normal text-blue-gray-700 outline outline-0 transition-all placeholder-shown:border placeholder-shown:border-blue-gray-200 placeholder-shown:border-t-blue-gray-200 focus:border-2 focus:border-gray-900 focus:border-t-transparent focus:outline-0 disabled:border-0 disabled:bg-blue-gray-50"
                placeholder=" " />
              <label
                class="before:content[' '] after:content[' '] pointer-events-none absolute left-0 -top-1.5 flex h-full w-full select-none !overflow-visible truncate text-[11px] font-normal leading-tight text-gray-500 transition-all before:pointer-events-none before:mt-[6.5px] before:mr-1 before:box-border before:block before:h-1.5 before:w-2.5 before:rounded-tl-md before:border-t before:border-l before:border-blue-gray-200 before:transition-all after:pointer-events-none after:mt-[6.5px] after:ml-1 after:box-border after:block after:h-1.5 after:w-2.5 after:flex-grow after:rounded-tr-md after:border-t after:border-r after:border-blue-gray-200 after:transition-all peer-placeholder-shown:text-sm peer-placeholder-shown:leading-[3.75] peer-placeholder-shown:text-blue-gray-500 peer-placeholder-shown:before:border-transparent peer-placeholder-shown:after:border-transparent peer-focus:text-[11px] peer-focus:leading-tight peer-focus:text-gray-900 peer-focus:before:border-t-2 peer-focus:before:border-l-2 peer-focus:before:!border-gray-900 peer-focus:after:border-t-2 peer-focus:after:border-r-2 peer-focus:after:!border-gray-900 peer-disabled:text-transparent peer-disabled:before:border-transparent peer-disabled:after:border-transparent peer-disabled:peer-placeholder-shown:text-blue-gray-500">
               mmmmm &#129300; &#128584 ...
              </label>
              <br><br>
              <button id="button1"onclick="toggleModal()" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded"> versionar &#128586;</button>

            </div>           
      </div>
      </div>
<div></div>
      <!--Modal--->
 
      <div class="contenedor_secundario"> 
        <div id="contenededor-spinner"><div id="posicion-spinner"><div id="spinner"></div></div></div>
          <button id="button1"onclick="toggleModal()" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">En que estas pensando? &#128584;</button>
          <div id="mi-div"></div>
      </div>
  </div>
  
    <script>
var inputMensaje = document.getElementById('inp');
var contenidoInput = inputMensaje.value.trim();
var mensaje = contenidoInput !== '' ? contenidoInput : 'No se que hacer hoy';

 

function Versionar(mensaje) {
  // Muestra un indicador de espera aquí (spinner, animación, etc.)
  // Por ejemplo, muestra un spinner en un div con el ID 'spinner'
  document.getElementById('contenededor-spinner').style.display = 'block';

  var url = "https://tweetv.onrender.com/publicacion";
  var data = { mensaje: mensaje };
  const controller = new AbortController();
  const timeoutId = setTimeout(() => controller.abort(), 60000); // Establece un tiempo de espera de 10 segundos (10000 milisegundos)


  fetch(url,{
    signal: controller.signal,
    method: "POST",
    body: JSON.stringify(data),
    headers: {
      "Content-Type": "application/json",
    },
  })
  .then(response => response.json())
  .then(data => {
    // Elimina el indicador de espera una vez que se recibe la respuesta
    document.getElementById('contenededor-spinner').style.display = 'none';

    for (const key in data) {
      if (data.hasOwnProperty(key)) {
        const bannerDiv = document.createElement('div');
        bannerDiv.className = 'item'
        bannerDiv.innerHTML = data[key];
        const bannerContainer = document.getElementById('mi-div');
        bannerContainer.appendChild(bannerDiv);
      }
    }
  })
  .catch(error => {
    console.error('Error:', error);
    // En caso de error, también elimina el indicador de espera
    document.getElementById('contenededor-spinner').style.display = 'none';
  });
}
 
Versionar(mensaje);

  


  document.addEventListener('DOMContentLoaded', function() {
      var modal = document.getElementById('myModal');
      modal.style.display = 'none';
  });

  function toggleModal() {
      var modal = document.getElementById('myModal');

      if (modal.style.display === 'block') {
          modal.style.display = 'none';
          var inputMensaje = document.getElementById('inp');
          var contenidoInput = inputMensaje.value.trim();
          var mensaje = contenidoInput.trim() !== '' ? contenidoInput : 'No se que hacer hoy';
          if (mensaje !== 'No se que hacer hoy') {
            Versionar(mensaje);
        }
      } else {
          modal.style.display = 'block';
      }
  }

  window.onclick = function(event) {
      var modal = document.getElementById('myModal');
      if (event.target == modal) {
          modal.style.display = 'none';
          localStorage.setItem('modalOpened', 'false');
      }
  }

  document.addEventListener('keydown', function(event) {
      var modal = document.getElementById('myModal');
      
      if (event.key === 'Enter' && modal.style.display == 'block') {
          toggleModal();
          versionar();

      }
  });




 

    </script>
</body>
</html>
 